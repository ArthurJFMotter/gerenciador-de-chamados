<div class="container">
    <!-- tabs module start -->
    <mat-tab-group mat-stretch-tabs (selectedTabChange)="onTabChange($event)" [selectedIndex]="selectedTabIndex">
        @for (tab of tabs; track tab) {
        <mat-tab>
            <ng-template mat-tab-label>
                <mat-icon class="tab-icon">{{ tabConfig[tab].icon }}</mat-icon>
                {{ tabConfig[tab].name }}
            </ng-template>
        </mat-tab>
        }
    </mat-tab-group>
    <!-- tabs module end -->

    <!-- queue module start -->
    <mat-tab-group mat-stretch-tabs (selectedTabChange)="onQueueChange($event)" [selectedIndex]="selectedQueueIndex">

        @for (queue of queues; track queue) {
        <mat-tab>
            <ng-template mat-tab-label>
                <mat-icon class="tab-icon">{{ queueConfig[queue].icon }}</mat-icon>
                {{ queueConfig[queue].name }}
                <span *ngIf="queueTicketCounts[queue] > 0" class="ticket-count">
                    {{queueTicketCounts[queue]}}
                </span>
            </ng-template>
        </mat-tab>
        }
    </mat-tab-group>
    <!-- queue module start -->

    <!-- ticket actions module start-->
    <app-ticket-actions (searchChange)="handleSearchChange($event)"
        (showTableChange)="handleShowTableChange($event)"></app-ticket-actions>
    <!-- ticket actions module end-->

    <!--main-ticket-content module start-->
    <div class="aux-container">
        <div *ngIf="loading">
            <mat-progress-spinner mode="indeterminate"></mat-progress-spinner>
        </div>
        <div *ngIf="error">
            Error: {{ error }}
        </div>
        <div *ngIf="!loading && !error">
            <div *ngIf="filteredTickets.length > 0; else noTickets">

                <app-ticket-table *ngIf="showTable === 'table'" [allTickets]="filteredTickets"
                    [currentPage]="currentPage" [pageSize]="pageSize" [searchTerm]="searchTerm">
                </app-ticket-table>

                <app-ticket-card *ngIf="showTable === 'card'" [allTickets]="filteredTickets" [currentPage]="currentPage"
                    [pageSize]="pageSize" [searchTerm]="searchTerm">
                </app-ticket-card>

            </div>
            <ng-template #noTickets>
                <div class="noTickets">
                    <img src="../../../assets/images/such-empty.svg" alt="No Tickets">
                    <p>Sem Tickets no Momento :P</p>
                </div>
            </ng-template>
        </div>
    </div>
    <!--main-ticket-content module end-->
    <!-- OBS: este modulo pode mudar de lugar-->
    <ng-container *ngIf="!loading && !error && filteredTickets.length > 0">
        <mat-paginator [length]="filteredTickets.length" [pageSize]="pageSize" [pageIndex]="currentPage-1"
            (page)="onPageChanged($event)" aria-label="Select page" [pageSizeOptions]="[15, 25, 50, 100, 200]">
        </mat-paginator>
    </ng-container>
    <!-- OBS: este modulo pode mudar de lugar-->
</div>